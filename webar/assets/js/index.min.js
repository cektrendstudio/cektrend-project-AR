const viewer = document.getElementById("model-viewer");
let data3d = ["animal", "padjajaran", "dino", "octaland", "space", "ocean"],
    url_appstore = ["https://apps.apple.com/us/app/animal-4d/id962983832", "https://apps.apple.com/us/app/dinosaur-4d/id1073564667", "https://apps.apple.com/us/app/octaland-4d/id1000598340", "https://apps.apple.com/us/app/space-4d/id1018109847", "https://apps.apple.com/us/app/ocean-4d/id1484774384"],
    url_playstore = ["https://play.google.com/store/apps/details?id=com.OctagonStudio.Animal4DPlus&hl=en", "https://play.google.com/store/apps/details?id=com.OctagonStudio.ARDinoVR&hl=en", "https://play.google.com/store/apps/details?id=com.OctagonStudio.Octaland&hl=en", "https://play.google.com/store/apps/details?id=com.OctagonStudio.SolarSys&hl=en", "https://play.google.com/store/apps/details?id=com.Octagon.Ocean4D"],
    orderNo = 0,
    lastOrder = data3d.length,
    bgm_model = new Howl({
        src: "./assets/audio/animal.mp3",
        volume: .7,
        loop: !1
    });
const onProgress = e => {
    const o = e.target.querySelector(".progress-bar");
    e.target.querySelector(".update-bar").style.width = `${100 * e.detail.totalProgress}%`, 1 === e.detail.totalProgress ? (o.classList.add("hide"), document.getElementById("header-logo").setAttribute("src", "./assets/images/" + data3d[orderNo] + "-logo.png"), bgm_model.play()) : o.classList.remove("hide")
};

function iOS() {
    return ["iPad Simulator", "iPhone Simulator", "iPod Simulator", "iPad", "iPhone", "iPod"].includes(navigator.platform) || navigator.userAgent.includes("Mac") && "ontouchend" in document
}

function changeShow(e) {
    bgm_model.stop();
    let o = viewer.getAttribute("data-model"),
        t = data3d.indexOf(o);
    orderNo = "next" == e ? ++t == data3d.length ? 0 : t : 0 == t ? data3d.length - 1 : t - 1;
    let a = data3d[orderNo] + ".mp3";
    bgm_model = new Howl({
        src: "./assets/audio/" + a,
        volume: .7,
        loop: !1
    }), viewer.setAttribute("data-model", data3d[orderNo]), viewer.setAttribute("src", "./assets/3d/" + data3d[orderNo] + ".glb"), viewer.setAttribute("ios-src", "./assets/3d/" + data3d[orderNo] + ".usdz")
}

function openStore(e) {
    var o = url_appstore[orderNo];
    "android" == e && (o = url_playstore[orderNo]), window.open(o, "_blank")
}
document.querySelector("model-viewer").addEventListener("progress", onProgress), iOS() ? document.getElementById("btn-marker").style.display = "block" : console.log("no");